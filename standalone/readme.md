# Самостоятельно работающая версия

## Вариант работающий на текущем коде 

Все это пока глубокая бэта для желающих поиграться. Возможно в процессе становления будут какие-то изменения с хранением настроек, но сама база вряд ли поменяется.

## Итак инструкция по установке

1. Создаем в удобном месте папку mbstandalone (название можете выбрать какое нравиться, это не принципиально)
2. Распаковываем в эту папку содержимое архива (папка mbplugin)
3. Из папки mbplugin\standalone перекладываем файлы в корень папки mbstandalone
4. Запустить ```mbstandalone.bat``` без параметров или с параметром init (при первом запуске он настроит параметры по умолчанию и создаст базу BalanceHistory.sqlite для хранения результатов)
5. Настроить телефоны в phones.ini, в папке mbplugin\standalone уже находится настроенный пример с двумя телефонами
ВАЖНО номера секций ([Phone] #2) не должны повторяться
6. Для проверки корректности ini файлов запустить ```mbstandalone.bat check``` диагностика пока так себе, со временем будем в эту сторону копать
7. Для получения балансов ```mbstandalone.bat getbalance```
8. Если нужно получить по части балансов запустите ```mbstandalone.bat getbalance filter1 filter2 ...``` будут получены только балансы у которых один из фильтров совпадет с плагином или логином
9. Для настройки автоматической проверки баланса необходимо по какому-то расписанию запускать ```mbstandalone.bat chechbalance``` например через системный планировщик ```taskschd.msc```либо как-то еще

## Для инфо

* На текущий момент доступен только просмотр веб страницы с балансом [http://localhost:19777/report](http://localhost:19777/report), открыть его можно выбрав Open report через иконку вебсервера в системном трее. 
* Также данная страница сохраняется в виде файла balance.html в корневой папке standalone версии
* В Standalone версии для получения баланса не требуется веб сервер, веб сервер нужен только для показа информации
* Все данные по балансам хранятся в файле BalanceHistory.sqlite в корне проекта, это база данных sqllite при желании можно поработать с ней из бругин програ для построения какой-то аналитики.
* При желании можно настроить телеграм бота так же как для обычной версии, но только по варианту 2 (см общий readme раздел Телеграм бот вариант 2 (получаем балансы из sqlite))
* При желании можно запустить несколько mbplugin одновременно из разных папок на разных портах, но возможны коллизии при управлении хромом, когда несколько разных плагинов попытаются запускать их одновременно

## Текущие проблемы

Слабая диагностика ошибок в phones.ini который пока правится руками.

## Дальнейшее развитие

* Запросить неудачные попытки
* В дальнейшем это частично переедет в вебсервер, где будет шедулер и подобный функционал.
